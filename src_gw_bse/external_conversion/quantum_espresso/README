------------------------------------
October 2017 
Minjung Kim (minjung.kim@yale.edu)
------------------------------------

pw2openatom.f90:
This script converts wavefunctions generated by Quantum Espresso to states files for OpenAtom.
It requires qexml module in quantum espresso package.
To compile this script, place this script in PP/src directory in quantum espresso packages, and add below two lines inside of the Makefile in PP/src directory:

pw2openatom.x: ../../Modules/qexml.o pw2openatom.o
	$(LD) $(LDFLAGS) -o $@ pw2openatom.o ../../Modules/qexml.o $(QEOBJS) $(LIBOBJS)

Run the executable at the working directory, 
e.g., the same directory where the <prefix>.save/ directory is located.

EXAMPLE:
<YOUR_QE_DIRECTORY>/PP/src/pw2openatom.x < input_file

In this directory, a sample input file is included (in.pw2openatom). 

Before running pw2openatom.x, STATES directory should exist in your working directory.
"makedir.sh" will create directories for you.
Usage for makewfndir.sh: 
./makewfndir.sh num_kpoint num_spin

num_kpoint is the number of k points of your system.
num_spin is the number of spin in your system.


====================================
INPUT FILE DESCRIPTION

prefix : it has to be the same as pwscf run
work_dir : directory where you saves your wavefunction files.
fsysname : system information file to be used for OpenAtom execution. The name of this file is hardcoded in OpenAtom as "sysinfo.dat". 
doublepack : Default value is 'false'. 
shift_flag : To calculate Polarizability when G=G'=q=0, we use shifted wavefunctions. If you have calculated occupied state wavefunctions with k grid with small shifts, make this flag true. 
gpp_flag : If true, it prints density file ("rho.dat") that is used for GPP calculations. 
Vxc_flag : not implemented yet.
nbandschunk : (optional) number of bands to be read for single qexml_read_wfc call. If this number is too small (e.g. like 1) and your system is big, it will take a lot of time. But if this number is too large, it may suffer from out of memory. If you don't specify this number, the converter assumes that the machine has 10GB of memory, and adjust this number accordingly. 
